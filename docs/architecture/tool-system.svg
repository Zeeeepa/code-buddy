<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 550">
  <defs>
    <linearGradient id="ragGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#7c3aed"/>
    </linearGradient>
    <linearGradient id="execGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="secGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ef4444"/>
      <stop offset="100%" style="stop-color:#dc2626"/>
    </linearGradient>
    <marker id="arrow2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="850" height="550" fill="#0f172a"/>

  <!-- Title -->
  <text x="425" y="35" text-anchor="middle" fill="#e2e8f0" font-family="system-ui" font-size="22" font-weight="bold">
    Tool System - RAG Selection &amp; Execution
  </text>

  <!-- Input Query -->
  <g transform="translate(50, 70)">
    <rect x="0" y="0" width="180" height="60" rx="10" fill="#1e293b" stroke="#6366f1" stroke-width="2"/>
    <text x="90" y="25" text-anchor="middle" fill="#a5b4fc" font-family="system-ui" font-size="12">User Query</text>
    <text x="90" y="45" text-anchor="middle" fill="#f1f5f9" font-family="system-ui" font-size="11">"Edit auth.ts line 50"</text>
  </g>

  <!-- Arrow to RAG -->
  <path d="M230,100 L280,100" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrow2)"/>

  <!-- RAG Tool Selection -->
  <g transform="translate(290, 60)">
    <rect x="0" y="0" width="250" height="120" rx="12" fill="url(#ragGrad)"/>
    <text x="125" y="25" text-anchor="middle" fill="#f5f3ff" font-family="system-ui" font-size="14" font-weight="bold">RAG Tool Selection</text>
    <text x="125" y="50" text-anchor="middle" fill="#ddd6fe" font-family="system-ui" font-size="11">Semantic matching</text>
    <text x="125" y="70" text-anchor="middle" fill="#ddd6fe" font-family="system-ui" font-size="11">Query → Tool embeddings</text>
    <rect x="20" y="82" width="210" height="30" rx="4" fill="#1e1b4b"/>
    <text x="125" y="102" text-anchor="middle" fill="#a5b4fc" font-family="system-ui" font-size="10">45 tools → 5-8 relevant</text>
  </g>

  <!-- Arrow to filtered tools -->
  <path d="M540,120 L590,120" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrow2)"/>

  <!-- Filtered Tools List -->
  <g transform="translate(600, 60)">
    <rect x="0" y="0" width="200" height="120" rx="10" fill="#1e293b" stroke="#8b5cf6" stroke-width="2"/>
    <text x="100" y="25" text-anchor="middle" fill="#c4b5fd" font-family="system-ui" font-size="13" font-weight="bold">Selected Tools</text>
    <text x="20" y="50" fill="#94a3b8" font-family="system-ui" font-size="11">✓ edit_file</text>
    <text x="20" y="70" fill="#94a3b8" font-family="system-ui" font-size="11">✓ read_file</text>
    <text x="20" y="90" fill="#94a3b8" font-family="system-ui" font-size="11">✓ glob</text>
    <text x="110" y="50" fill="#64748b" font-family="system-ui" font-size="11">✗ bash</text>
    <text x="110" y="70" fill="#64748b" font-family="system-ui" font-size="11">✗ fetch</text>
    <text x="110" y="90" fill="#64748b" font-family="system-ui" font-size="11">✗ git_*</text>
    <text x="100" y="110" text-anchor="middle" fill="#6b7280" font-family="system-ui" font-size="10">-85% prompt tokens</text>
  </g>

  <!-- Tool Categories Box -->
  <g transform="translate(50, 200)">
    <rect x="0" y="0" width="750" height="150" rx="10" fill="#1e293b" stroke="#475569" stroke-width="1"/>
    <text x="375" y="25" text-anchor="middle" fill="#94a3b8" font-family="system-ui" font-size="14" font-weight="bold">45+ Tool Categories</text>

    <!-- File Tools -->
    <g transform="translate(30, 45)">
      <rect x="0" y="0" width="140" height="90" rx="6" fill="#1e3a8a" stroke="#3b82f6" stroke-width="1"/>
      <text x="70" y="20" text-anchor="middle" fill="#93c5fd" font-family="system-ui" font-size="11" font-weight="bold">File Tools</text>
      <text x="15" y="40" fill="#64748b" font-family="system-ui" font-size="10">read_file</text>
      <text x="15" y="55" fill="#64748b" font-family="system-ui" font-size="10">write_file</text>
      <text x="15" y="70" fill="#64748b" font-family="system-ui" font-size="10">edit_file</text>
      <text x="15" y="85" fill="#64748b" font-family="system-ui" font-size="10">multi_edit</text>
    </g>

    <!-- Search Tools -->
    <g transform="translate(190, 45)">
      <rect x="0" y="0" width="140" height="90" rx="6" fill="#064e3b" stroke="#10b981" stroke-width="1"/>
      <text x="70" y="20" text-anchor="middle" fill="#6ee7b7" font-family="system-ui" font-size="11" font-weight="bold">Search Tools</text>
      <text x="15" y="40" fill="#64748b" font-family="system-ui" font-size="10">glob</text>
      <text x="15" y="55" fill="#64748b" font-family="system-ui" font-size="10">grep</text>
      <text x="15" y="70" fill="#64748b" font-family="system-ui" font-size="10">web_search</text>
      <text x="15" y="85" fill="#64748b" font-family="system-ui" font-size="10">codebase_search</text>
    </g>

    <!-- System Tools -->
    <g transform="translate(350, 45)">
      <rect x="0" y="0" width="140" height="90" rx="6" fill="#78350f" stroke="#f59e0b" stroke-width="1"/>
      <text x="70" y="20" text-anchor="middle" fill="#fde68a" font-family="system-ui" font-size="11" font-weight="bold">System Tools</text>
      <text x="15" y="40" fill="#64748b" font-family="system-ui" font-size="10">bash</text>
      <text x="15" y="55" fill="#64748b" font-family="system-ui" font-size="10">git_*</text>
      <text x="15" y="70" fill="#64748b" font-family="system-ui" font-size="10">npm_*</text>
      <text x="15" y="85" fill="#64748b" font-family="system-ui" font-size="10">docker_*</text>
    </g>

    <!-- AI Tools -->
    <g transform="translate(510, 45)">
      <rect x="0" y="0" width="140" height="90" rx="6" fill="#581c87" stroke="#a855f7" stroke-width="1"/>
      <text x="70" y="20" text-anchor="middle" fill="#d8b4fe" font-family="system-ui" font-size="11" font-weight="bold">AI Tools</text>
      <text x="15" y="40" fill="#64748b" font-family="system-ui" font-size="10">think</text>
      <text x="15" y="55" fill="#64748b" font-family="system-ui" font-size="10">plan</text>
      <text x="15" y="70" fill="#64748b" font-family="system-ui" font-size="10">delegate</text>
      <text x="15" y="85" fill="#64748b" font-family="system-ui" font-size="10">code_review</text>
    </g>

    <!-- More -->
    <g transform="translate(670, 45)">
      <rect x="0" y="0" width="60" height="90" rx="6" fill="#1e293b" stroke="#64748b" stroke-width="1"/>
      <text x="30" y="50" text-anchor="middle" fill="#64748b" font-family="system-ui" font-size="10">+30</text>
      <text x="30" y="65" text-anchor="middle" fill="#64748b" font-family="system-ui" font-size="10">more</text>
    </g>
  </g>

  <!-- Security Layer -->
  <g transform="translate(50, 380)">
    <rect x="0" y="0" width="350" height="130" rx="12" fill="url(#secGrad)"/>
    <text x="175" y="25" text-anchor="middle" fill="#fecaca" font-family="system-ui" font-size="14" font-weight="bold">Security Layer</text>

    <g transform="translate(20, 40)">
      <rect x="0" y="0" width="145" height="75" rx="6" fill="#450a0a"/>
      <text x="72" y="20" text-anchor="middle" fill="#fca5a5" font-family="system-ui" font-size="11" font-weight="bold">Confirmation</text>
      <text x="10" y="40" fill="#94a3b8" font-family="system-ui" font-size="9">• File modifications</text>
      <text x="10" y="55" fill="#94a3b8" font-family="system-ui" font-size="9">• Bash commands</text>
      <text x="10" y="70" fill="#94a3b8" font-family="system-ui" font-size="9">• Destructive ops</text>
    </g>

    <g transform="translate(180, 40)">
      <rect x="0" y="0" width="145" height="75" rx="6" fill="#450a0a"/>
      <text x="72" y="20" text-anchor="middle" fill="#fca5a5" font-family="system-ui" font-size="11" font-weight="bold">Security Modes</text>
      <text x="10" y="40" fill="#94a3b8" font-family="system-ui" font-size="9">• suggest (ask all)</text>
      <text x="10" y="55" fill="#94a3b8" font-family="system-ui" font-size="9">• auto-edit (safe ops)</text>
      <text x="10" y="70" fill="#94a3b8" font-family="system-ui" font-size="9">• full-auto (all)</text>
    </g>
  </g>

  <!-- Execution Engine -->
  <g transform="translate(430, 380)">
    <rect x="0" y="0" width="370" height="130" rx="12" fill="url(#execGrad)"/>
    <text x="185" y="25" text-anchor="middle" fill="#d1fae5" font-family="system-ui" font-size="14" font-weight="bold">Execution Engine</text>

    <g transform="translate(20, 40)">
      <rect x="0" y="0" width="155" height="75" rx="6" fill="#064e3b"/>
      <text x="77" y="20" text-anchor="middle" fill="#6ee7b7" font-family="system-ui" font-size="11" font-weight="bold">Parallel Exec</text>
      <text x="10" y="40" fill="#94a3b8" font-family="system-ui" font-size="9">• Independent tools</text>
      <text x="10" y="55" fill="#94a3b8" font-family="system-ui" font-size="9">• Batch operations</text>
      <text x="10" y="70" fill="#94a3b8" font-family="system-ui" font-size="9">• Async handling</text>
    </g>

    <g transform="translate(190, 40)">
      <rect x="0" y="0" width="155" height="75" rx="6" fill="#064e3b"/>
      <text x="77" y="20" text-anchor="middle" fill="#6ee7b7" font-family="system-ui" font-size="11" font-weight="bold">Checkpoints</text>
      <text x="10" y="40" fill="#94a3b8" font-family="system-ui" font-size="9">• Auto backup</text>
      <text x="10" y="55" fill="#94a3b8" font-family="system-ui" font-size="9">• Undo support</text>
      <text x="10" y="70" fill="#94a3b8" font-family="system-ui" font-size="9">• File restore</text>
    </g>
  </g>

  <!-- Legend -->
  <g transform="translate(50, 530)">
    <rect x="0" y="-15" width="12" height="12" fill="url(#ragGrad)"/>
    <text x="18" y="-5" fill="#94a3b8" font-family="system-ui" font-size="10">RAG Selection</text>
    <rect x="120" y="-15" width="12" height="12" fill="url(#secGrad)"/>
    <text x="138" y="-5" fill="#94a3b8" font-family="system-ui" font-size="10">Security</text>
    <rect x="220" y="-15" width="12" height="12" fill="url(#execGrad)"/>
    <text x="238" y="-5" fill="#94a3b8" font-family="system-ui" font-size="10">Execution</text>
  </g>
</svg>
